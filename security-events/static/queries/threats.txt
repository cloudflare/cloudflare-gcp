SELECT ClientASN, EdgePathingOp, ClientCountry, ClientDeviceType, ClientIP, ClientRequestBytes, ClientRequestHost, ClientRequestMethod, ClientRequestProtocol, ClientRequestReferer, ClientRequestURI, ClientRequestUserAgent, ClientSrcPort, ClientSSLCipher, ClientSSLProtocol, EdgeColoID, EdgeEndTimestamp, EdgePathingSrc, EdgePathingStatus, EdgeResponseBytes, EdgeResponseContentType, EdgeResponseStatus, EdgeStartTimestamp, OriginIP, OriginResponseStatus, RayID, WAFAction, WAFFlags, WAFMatchedVar, WAFProfile, WAFRuleID, WAFRuleMessage FROM `BQ_DATASET` WHERE EdgeResponseStatus BETWEEN 400 and 428 AND EdgeResponseStatus != 404 GROUP BY ClientASN, EdgePathingOp, ClientCountry, ClientDeviceType, ClientIP, ClientRequestBytes, ClientRequestHost, ClientRequestMethod, ClientRequestProtocol, ClientRequestReferer, ClientRequestURI, ClientRequestUserAgent, ClientSrcPort, ClientSSLCipher, ClientSSLProtocol, EdgeColoID, EdgeEndTimestamp, EdgePathingSrc, EdgePathingStatus, EdgeResponseBytes, EdgeResponseContentType, EdgeResponseStatus, EdgeStartTimestamp, OriginIP, OriginResponseStatus, RayID, WAFAction, WAFFlags, WAFMatchedVar, WAFProfile, WAFRuleID, WAFRuleMessage ORDER BY EdgeStartTimestamp DESC LIMIT 1000
