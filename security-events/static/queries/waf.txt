SELECT ClientASN, EdgePathingOp, ClientCountry, ClientDeviceType, ClientIP, ClientRequestBytes, ClientRequestHost, ClientRequestMethod, ClientRequestProtocol, ClientRequestReferer, ClientRequestURI, ClientRequestUserAgent, ClientSrcPort, ClientSSLCipher, ClientSSLProtocol, EdgeColoID, EdgeEndTimestamp, EdgePathingSrc, EdgePathingStatus, EdgeResponseBytes, EdgeResponseContentType, EdgeResponseStatus, EdgeStartTimestamp, OriginIP, OriginResponseStatus, RayID, WAFAction, WAFFlags, WAFMatchedVar, WAFProfile, WAFRuleID, WAFRuleMessage AS cloudflare_logs FROM `BQ_DATASET` WHERE((cloudflare_logs.WAFRuleID IS NOT NULL AND LENGTH(cloudflare_logs.WAFRuleID) <> 0)) GROUP BY ClientASN, EdgePathingOp, ClientCountry, ClientDeviceType, ClientIP, ClientRequestBytes, ClientRequestHost, ClientRequestMethod, ClientRequestProtocol, ClientRequestReferer, ClientRequestURI, ClientRequestUserAgent, ClientSrcPort, ClientSSLCipher, ClientSSLProtocol, EdgeColoID, EdgeEndTimestamp, EdgePathingSrc, EdgePathingStatus, EdgeResponseBytes, EdgeResponseContentType, EdgeResponseStatus, EdgeStartTimestamp, OriginIP, OriginResponseStatus, RayID, WAFAction, WAFFlags, WAFMatchedVar, WAFProfile, WAFRuleID, WAFRuleMessage ORDER BY EdgeEndTimestamp DESC LIMIT 500
